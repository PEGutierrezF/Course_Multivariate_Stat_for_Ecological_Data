---
title: "RDA"
author: "Pablo E. Guti√©rrez-Fonseca"
date: "10/27/2021"
output: pdf_document
---


1. Primer paso: cargar las librerias que necesitas.


```{r, warning=FALSE, message=FALSE}

library(BiodiversityR)
library(ggrepel)
library(ggplot2)
library(readxl)
library(ggsci)
library(ggforce)
library(dplyr)

```



2. Segundo paso: cargar los datos.

```{r}

species=read.csv("data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("data/RDA_environmetal.csv", header=T, row.names=NULL, sep=",")

```



3.  Before we can use this explanatory matrix we need to check 
that its rows are in the same order as our response matrix
all.equal(rownames(species), rownames(env))

```{r}

all.equal(rownames(species), rownames(env))

```



4. Remover la columna de sitos.
```{r}
species_1 <- select(species, -site)
env_1 <- select(env, -site)
```



5.  Transformar datos.
# Apply log+1 transformation to your species occurrences data (spe matrix) 
# in order to correct for possible statistical errors associated to rare or very 
#common species

```{r}
species_2 <- decostand(species_1, method = "hellinger")

```



6. # vegan requires that we write out each term if we are not going to 
# convert the factor to a dummy matrix

```{r}
rda_tree_all = vegan::rda(species_2 ~ temperature + pH +
                 oxygen + conductivity + plants, data= env_1, scale = TRUE)
rda_tree_all
```

7. Summary
```{r}
summary(rda_tree_all)

head (summary (rda_tree_all))
```

8. Plots
```{r}
screeplot(rda_tree_all)
```


9. Ordination plots
```{r}
plot(rda_tree_all, scaling=1, main="Odonata in Urban ponds")
spe.sc <- scores(rda_tree_all, choices=1:2, scaling=1, display="sp")
arrows(0,0,spe.sc[,1], spe.sc[,2], length=0, lty=1, col='red')
```

10. Calcular las R

```{r}
(R2 <- RsquareAdj(rda_tree_all)$r.squared)

(R2adj <- RsquareAdj(rda_tree_all)$adj.r.squared)

```
